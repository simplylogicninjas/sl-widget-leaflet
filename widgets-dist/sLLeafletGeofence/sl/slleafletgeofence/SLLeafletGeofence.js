define(['exports', 'react', 'big.js'], (function (exports, React, Big) { 'use strict';

    function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

    var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
    var Big__default = /*#__PURE__*/_interopDefaultLegacy(Big);

    var ActionType;
    (function (ActionType) {
        ActionType[ActionType["SetMapReady"] = 0] = "SetMapReady";
        ActionType[ActionType["SetMapName"] = 1] = "SetMapName";
        ActionType[ActionType["SetMarkers"] = 2] = "SetMarkers";
        ActionType[ActionType["SetGeoJSON"] = 3] = "SetGeoJSON";
        ActionType[ActionType["SetGeoJSONAction"] = 4] = "SetGeoJSONAction";
        ActionType[ActionType["SetGeofence"] = 5] = "SetGeofence";
        ActionType[ActionType["SetGeofenceAction"] = 6] = "SetGeofenceAction";
        ActionType[ActionType["SetGeofenceOutAction"] = 7] = "SetGeofenceOutAction";
        ActionType[ActionType["SetGeofencePositionAction"] = 8] = "SetGeofencePositionAction";
        ActionType[ActionType["SetGeofenceOptions"] = 9] = "SetGeofenceOptions";
        ActionType[ActionType["SetMarkerAction"] = 10] = "SetMarkerAction";
        ActionType[ActionType["SetMarkerDragAction"] = 11] = "SetMarkerDragAction";
    })(ActionType || (ActionType = {}));
    function updateGeofence(data) {
        return {
            type: ActionType.SetGeofence,
            payload: [...data]
        };
    }
    function updateGeofenceAction(data) {
        return {
            type: ActionType.SetGeofenceAction,
            payload: data
        };
    }
    function updateGeofenceOutAction(data) {
        return {
            type: ActionType.SetGeofenceOutAction,
            payload: data
        };
    }
    function updateGeofencePositionAction(data) {
        return {
            type: ActionType.SetGeofencePositionAction,
            payload: data
        };
    }
    function updateGeofenceOptions(data) {
        return {
            type: ActionType.SetGeofenceOptions,
            payload: data
        };
    }

    const canSetAttributeValue = (attributeValue) => {
        return attributeValue && attributeValue.status === "available" /* Available */;
    };
    const isDifferentData = (currentData, newData) => {
        return JSON.stringify(currentData) !== JSON.stringify(newData);
    };
    function SLLeafletGeofence(props) {
        const { state, dispatch } = React.useContext(mx.slmap.context);
        const dataRef = React.useRef([]);
        const actionOut = React.useRef();
        const actionOutID = React.useRef();
        const actionIn = React.useRef();
        const actionInID = React.useRef();
        const actionInDistance = React.useRef();
        const getDefaultRadius = () => {
            var _a, _b;
            return (_b = (_a = props.defaultRadius.value) === null || _a === void 0 ? void 0 : _a.toNumber()) !== null && _b !== void 0 ? _b : 30;
        };
        const loadGeofence = (items) => {
            const data = items
                .map(item => {
                var _a, _b, _c, _d;
                if (props.id.get(item).value && props.latitude.get(item).value && props.longitude.get(item).value) {
                    return {
                        id: props.id.get(item).value.toString(),
                        position: [
                            parseFloat(props.latitude.get(item).value),
                            parseFloat(props.longitude.get(item).value)
                        ],
                        radius: props.radius
                            ? (_b = (_a = props.radius.get(item).value) === null || _a === void 0 ? void 0 : _a.toNumber()) !== null && _b !== void 0 ? _b : getDefaultRadius()
                            : getDefaultRadius(),
                        defaultColor: props.defaultColor && props.defaultColor.get(item)
                            ? (_c = props.defaultColor.get(item).value) !== null && _c !== void 0 ? _c : "#264ae5"
                            : "#264ae5",
                        activeColor: props.activeColor && props.activeColor.get(item)
                            ? (_d = props.activeColor.get(item).value) !== null && _d !== void 0 ? _d : "#3cb33d"
                            : "#3cb33d",
                        strokeOpacity: props.strokeOpacity && props.strokeOpacity.get(item) ? props.strokeOpacity.get(item) : 1.0,
                        strokeWeight: props.strokeWeight && props.strokeWeight.get(item) ? props.strokeWeight.get(item) : 3,
                        fillOpacity: props.fillOpacity && props.fillOpacity.get(item) ? props.fillOpacity.get(item) : 1.0
                    };
                }
                else {
                    return undefined;
                }
            })
                .filter(it => !!it);
            if (isDifferentData(data, dataRef.current)) {
                dataRef.current = data;
                dispatch(updateGeofence([...data]));
            }
        };
        const onGeofence = (id, metadata) => {
            if (actionIn.current) {
                if (actionIn.current.canExecute) {
                    if (canSetAttributeValue(actionInID.current) && canSetAttributeValue(actionInDistance.current)) {
                        actionInID.current.setValue(id);
                        actionInDistance.current.setValue(new Big__default["default"](metadata.toFixed(2)));
                        actionIn.current.execute();
                    }
                    else {
                        console.warn("Cannot set Geofence ID and Geofence distance attribute");
                    }
                }
                else {
                    console.warn("Cannot execute Geofence IN event");
                }
            }
        };
        const onGeofenceOut = (id) => {
            if (actionOut.current) {
                if (actionOut.current.canExecute) {
                    if (canSetAttributeValue(actionOutID.current)) {
                        actionOutID.current.setValue(id);
                        actionOut.current.execute();
                    }
                    else {
                        console.warn("Cannot set Geofence Out ID attribute");
                    }
                }
                else {
                    console.warn("Cannot execute Geofence OUT event");
                }
            }
        };
        const onGeofencePosition = (lat, long) => {
            if (props.onGeofenceCurrentPositionAction &&
                props.onGeofenceCurrentPositionLatitude &&
                props.onGeofenceCurrentPositionLongitude) {
                props.onGeofenceCurrentPositionLatitude.setValue(lat);
                props.onGeofenceCurrentPositionLongitude.setValue(long);
                props.onGeofenceCurrentPositionAction.execute();
            }
        };
        React.useEffect(() => {
            if (state.mapReady && props.data.items) {
                loadGeofence(props.data.items);
            }
        }, [props.data.items, state.mapReady]);
        React.useEffect(() => {
            var _a, _b, _c, _d;
            dispatch(updateGeofenceOptions({
                enabled: (_a = props.geofenceEnabled.value) !== null && _a !== void 0 ? _a : true,
                setView: (_b = props.geofenceSetViewEnabled.value) !== null && _b !== void 0 ? _b : true,
                maximumAge: (_d = (_c = props.maximumAge.value) === null || _c === void 0 ? void 0 : _c.toNumber()) !== null && _d !== void 0 ? _d : 0
            }));
        }, [props.maximumAge.value, props.geofenceEnabled.value, props.geofenceSetViewEnabled.value]);
        React.useEffect(() => {
            actionIn.current = props.onGeofenceAction;
            actionInID.current = props.onGeofenceId;
            actionInDistance.current = props.onGeofenceDistance;
            actionOut.current = props.onGeofenceOutAction;
            actionOutID.current = props.onGeofenceOutId;
            if (props.onGeofenceAction &&
                props.onGeofenceId &&
                props.onGeofenceAction.canExecute &&
                !state.geofenceAction) {
                dispatch(updateGeofenceAction(onGeofence));
            }
            if (props.onGeofenceOutAction &&
                props.onGeofenceOutId &&
                props.onGeofenceOutAction.canExecute &&
                !state.geofenceOutAction) {
                dispatch(updateGeofenceOutAction(onGeofenceOut));
            }
            if (props.onGeofenceCurrentPositionAction &&
                props.onGeofenceCurrentPositionLatitude &&
                props.onGeofenceCurrentPositionLongitude &&
                props.onGeofenceCurrentPositionAction.canExecute &&
                !state.geofencePositionAction) {
                dispatch(updateGeofencePositionAction(onGeofencePosition));
            }
        }, [
            props.onGeofenceAction,
            props.onGeofenceId,
            props.onGeofenceOutAction,
            props.onGeofenceOutId,
            props.onGeofenceCurrentPositionAction,
            props.onGeofenceCurrentPositionLatitude,
            props.onGeofenceCurrentPositionLongitude
        ]);
        return React.createElement(React__default["default"].Fragment, null);
    }

    exports.SLLeafletGeofence = SLLeafletGeofence;

    Object.defineProperty(exports, '__esModule', { value: true });

}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU0xMZWFmbGV0R2VvZmVuY2UuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NoYXJlZC90eXBlcy9yZWR1Y2VyLmludGVyZmFjZS50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9TTExlYWZsZXRHZW9mZW5jZS50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSWRlbnRpZmllckFjdGlvbiwgSUdlb2ZlbmNlLCBJR2VvZmVuY2VMb2NhdGVPcHRpb25zLCBJTWFya2VyLCBMYXRMbmdBY3Rpb24gfSBmcm9tIFwiLi9tYXAuaW50ZXJmYWNlXCI7XHJcblxyXG5leHBvcnQgZW51bSBBY3Rpb25UeXBlIHtcclxuICAgIFNldE1hcFJlYWR5LFxyXG4gICAgU2V0TWFwTmFtZSxcclxuICAgIFNldE1hcmtlcnMsXHJcbiAgICBTZXRHZW9KU09OLFxyXG4gICAgU2V0R2VvSlNPTkFjdGlvbixcclxuICAgIFNldEdlb2ZlbmNlLFxyXG4gICAgU2V0R2VvZmVuY2VBY3Rpb24sXHJcbiAgICBTZXRHZW9mZW5jZU91dEFjdGlvbixcclxuICAgIFNldEdlb2ZlbmNlUG9zaXRpb25BY3Rpb24sXHJcbiAgICBTZXRHZW9mZW5jZU9wdGlvbnMsXHJcbiAgICBTZXRNYXJrZXJBY3Rpb24sXHJcbiAgICBTZXRNYXJrZXJEcmFnQWN0aW9uXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNldE1hcFJlYWR5IHtcclxuICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0TWFwUmVhZHksXHJcbiAgICBwYXlsb2FkOiB7bWFwUmVhZHk6IGJvb2xlYW59O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElTZXRNYXBOYW1lIHtcclxuICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0TWFwTmFtZSxcclxuICAgIHBheWxvYWQ6IHttYXBOYW1lOiBzdHJpbmd9O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElTZXRNYXJrZXJzIHtcclxuICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0TWFya2VycyxcclxuICAgIHBheWxvYWQ6IElNYXJrZXJbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJU2V0R2VvSlNPTiB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb0pTT04sXHJcbiAgICBwYXlsb2FkOiBhbnlbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJU2V0R2VvSlNPTkFjdGlvbiB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb0pTT05BY3Rpb24sXHJcbiAgICBwYXlsb2FkOiBJZGVudGlmaWVyQWN0aW9uO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElTZXRHZW9mZW5jZSB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlLFxyXG4gICAgcGF5bG9hZDogSUdlb2ZlbmNlW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNldEdlb2ZlbmNlQWN0aW9uIHtcclxuICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0R2VvZmVuY2VBY3Rpb24sXHJcbiAgICBwYXlsb2FkOiBJZGVudGlmaWVyQWN0aW9uO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElTZXRHZW9mZW5jZU91dEFjdGlvbiB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlT3V0QWN0aW9uLFxyXG4gICAgcGF5bG9hZDogSWRlbnRpZmllckFjdGlvbjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJU2V0R2VvZmVuY2VQb3NpdGlvbkFjdGlvbiB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlUG9zaXRpb25BY3Rpb24sXHJcbiAgICBwYXlsb2FkOiBMYXRMbmdBY3Rpb247XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNldEdlb2ZlbmNlT3B0aW9ucyB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlT3B0aW9ucyxcclxuICAgIHBheWxvYWQ6IElHZW9mZW5jZUxvY2F0ZU9wdGlvbnM7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNldE1hcmtlckFjdGlvbiB7XHJcbiAgICB0eXBlOiBBY3Rpb25UeXBlLlNldE1hcmtlckFjdGlvbixcclxuICAgIHBheWxvYWQ6IElkZW50aWZpZXJBY3Rpb247XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSVNldE1hcmtlckRyYWdBY3Rpb24ge1xyXG4gICAgdHlwZTogQWN0aW9uVHlwZS5TZXRNYXJrZXJEcmFnQWN0aW9uLFxyXG4gICAgcGF5bG9hZDogTGF0TG5nQWN0aW9uO1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBJR2xvYmFsU3RhdGVBY3Rpb25zID0gSVNldE1hcFJlYWR5IHwgSVNldE1hcE5hbWUgfCBJU2V0TWFya2VycyB8IElTZXRHZW9KU09OIHwgSVNldEdlb0pTT05BY3Rpb24gfCBJU2V0R2VvZmVuY2UgfCBJU2V0R2VvZmVuY2VBY3Rpb24gfCBJU2V0R2VvZmVuY2VPdXRBY3Rpb24gfCBJU2V0R2VvZmVuY2VQb3NpdGlvbkFjdGlvbiB8IElTZXRHZW9mZW5jZU9wdGlvbnMgfCBJU2V0TWFya2VyQWN0aW9uIHwgSVNldE1hcmtlckRyYWdBY3Rpb247XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTWFwUmVhZHkobWFwUmVhZHk6IGJvb2xlYW4pOiBJU2V0TWFwUmVhZHkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldE1hcFJlYWR5LFxyXG4gICAgICAgIHBheWxvYWQ6IHttYXBSZWFkeX1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1hcE5hbWUobWFwTmFtZTogc3RyaW5nKTogSVNldE1hcE5hbWUge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldE1hcE5hbWUsXHJcbiAgICAgICAgcGF5bG9hZDoge21hcE5hbWV9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNYXJrZXJzKG1hcmtlcnM6IElNYXJrZXJbXSk6IElTZXRNYXJrZXJzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdHlwZTogQWN0aW9uVHlwZS5TZXRNYXJrZXJzLFxyXG4gICAgICAgIHBheWxvYWQ6IFsuLi5tYXJrZXJzXVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvSlNPTihkYXRhOiBhbnlbXSk6IElTZXRHZW9KU09OIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdHlwZTogQWN0aW9uVHlwZS5TZXRHZW9KU09OLFxyXG4gICAgICAgIHBheWxvYWQ6IFsuLi5kYXRhXVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvSlNPTkFjdGlvbihkYXRhOiBJZGVudGlmaWVyQWN0aW9uKTogSVNldEdlb0pTT05BY3Rpb24ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb0pTT05BY3Rpb24sXHJcbiAgICAgICAgcGF5bG9hZDogZGF0YVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvZmVuY2UoZGF0YTogSUdlb2ZlbmNlW10pOiBJU2V0R2VvZmVuY2Uge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlLFxyXG4gICAgICAgIHBheWxvYWQ6IFsuLi5kYXRhXVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvZmVuY2VBY3Rpb24oZGF0YTogSWRlbnRpZmllckFjdGlvbik6IElTZXRHZW9mZW5jZUFjdGlvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0R2VvZmVuY2VBY3Rpb24sXHJcbiAgICAgICAgcGF5bG9hZDogZGF0YVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvZmVuY2VPdXRBY3Rpb24oZGF0YTogSWRlbnRpZmllckFjdGlvbik6IElTZXRHZW9mZW5jZU91dEFjdGlvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0R2VvZmVuY2VPdXRBY3Rpb24sXHJcbiAgICAgICAgcGF5bG9hZDogZGF0YVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR2VvZmVuY2VQb3NpdGlvbkFjdGlvbihkYXRhOiBMYXRMbmdBY3Rpb24pOiBJU2V0R2VvZmVuY2VQb3NpdGlvbkFjdGlvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHR5cGU6IEFjdGlvblR5cGUuU2V0R2VvZmVuY2VQb3NpdGlvbkFjdGlvbixcclxuICAgICAgICBwYXlsb2FkOiBkYXRhXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVHZW9mZW5jZU9wdGlvbnMoZGF0YTogSUdlb2ZlbmNlTG9jYXRlT3B0aW9ucyk6IElTZXRHZW9mZW5jZU9wdGlvbnMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldEdlb2ZlbmNlT3B0aW9ucyxcclxuICAgICAgICBwYXlsb2FkOiBkYXRhXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNYXJrZXJBY3Rpb24oZGF0YTogSWRlbnRpZmllckFjdGlvbik6IElTZXRNYXJrZXJBY3Rpb24ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0eXBlOiBBY3Rpb25UeXBlLlNldE1hcmtlckFjdGlvbixcclxuICAgICAgICBwYXlsb2FkOiBkYXRhXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNYXJrZXJEcmFnQWN0aW9uKGRhdGE6IExhdExuZ0FjdGlvbik6IElTZXRNYXJrZXJEcmFnQWN0aW9uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdHlwZTogQWN0aW9uVHlwZS5TZXRNYXJrZXJEcmFnQWN0aW9uLFxyXG4gICAgICAgIHBheWxvYWQ6IGRhdGFcclxuICAgIH1cclxufSIsImltcG9ydCBSZWFjdCwgeyBSZWFjdEVsZW1lbnQsIGNyZWF0ZUVsZW1lbnQsIHVzZUVmZmVjdCwgdXNlQ29udGV4dCwgdXNlUmVmIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBPYmplY3RJdGVtLCBBY3Rpb25WYWx1ZSwgRWRpdGFibGVWYWx1ZSwgVmFsdWVTdGF0dXMgfSBmcm9tIFwibWVuZGl4XCI7XG5cbmltcG9ydCB7IFNMTGVhZmxldEdlb2ZlbmNlQ29udGFpbmVyUHJvcHMgfSBmcm9tIFwiLi4vdHlwaW5ncy9TTExlYWZsZXRHZW9mZW5jZVByb3BzXCI7XG5cbmltcG9ydCBcIi4vdWkvU0xMZWFmbGV0R2VvZmVuY2UuY3NzXCI7XG5pbXBvcnQgeyBJR2xvYmFsQ29udGV4dCB9IGZyb20gXCIuLi8uLi8uLi9zaGFyZWQvdHlwZXMvY29udGV4dC5pbnRlcmZhY2VcIjtcbmltcG9ydCB7IElHZW9mZW5jZSB9IGZyb20gXCIuLi8uLi8uLi9zaGFyZWQvdHlwZXMvbWFwLmludGVyZmFjZVwiO1xuaW1wb3J0IHtcbiAgICB1cGRhdGVHZW9mZW5jZSxcbiAgICB1cGRhdGVHZW9mZW5jZUFjdGlvbixcbiAgICB1cGRhdGVHZW9mZW5jZU9wdGlvbnMsXG4gICAgdXBkYXRlR2VvZmVuY2VPdXRBY3Rpb24sXG4gICAgdXBkYXRlR2VvZmVuY2VQb3NpdGlvbkFjdGlvblxufSBmcm9tIFwiLi4vLi4vLi4vc2hhcmVkL3R5cGVzL3JlZHVjZXIuaW50ZXJmYWNlXCI7XG5pbXBvcnQgQmlnIGZyb20gXCJiaWcuanNcIjtcblxuZGVjbGFyZSBsZXQgbXg6IGFueTtcblxuY29uc3QgY2FuU2V0QXR0cmlidXRlVmFsdWUgPSAoYXR0cmlidXRlVmFsdWU6IEVkaXRhYmxlVmFsdWUgfCB1bmRlZmluZWQpID0+IHtcbiAgICByZXR1cm4gYXR0cmlidXRlVmFsdWUgJiYgYXR0cmlidXRlVmFsdWUuc3RhdHVzID09PSBWYWx1ZVN0YXR1cy5BdmFpbGFibGU7XG59O1xuXG5jb25zdCBpc0RpZmZlcmVudERhdGEgPSAoY3VycmVudERhdGE6IElHZW9mZW5jZVtdLCBuZXdEYXRhOiBJR2VvZmVuY2VbXSkgPT4ge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShjdXJyZW50RGF0YSkgIT09IEpTT04uc3RyaW5naWZ5KG5ld0RhdGEpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIFNMTGVhZmxldEdlb2ZlbmNlKHByb3BzOiBTTExlYWZsZXRHZW9mZW5jZUNvbnRhaW5lclByb3BzKTogUmVhY3RFbGVtZW50IHtcbiAgICBjb25zdCB7IHN0YXRlLCBkaXNwYXRjaCB9ID0gdXNlQ29udGV4dDxJR2xvYmFsQ29udGV4dD4obXguc2xtYXAuY29udGV4dCk7XG4gICAgY29uc3QgZGF0YVJlZiA9IHVzZVJlZjxJR2VvZmVuY2VbXT4oW10pO1xuICAgIGNvbnN0IGFjdGlvbk91dCA9IHVzZVJlZjxBY3Rpb25WYWx1ZT4oKTtcbiAgICBjb25zdCBhY3Rpb25PdXRJRCA9IHVzZVJlZjxFZGl0YWJsZVZhbHVlPHN0cmluZyB8IEJpZz4+KCk7XG4gICAgY29uc3QgYWN0aW9uSW4gPSB1c2VSZWY8QWN0aW9uVmFsdWU+KCk7XG4gICAgY29uc3QgYWN0aW9uSW5JRCA9IHVzZVJlZjxFZGl0YWJsZVZhbHVlPHN0cmluZyB8IEJpZz4+KCk7XG4gICAgY29uc3QgYWN0aW9uSW5EaXN0YW5jZSA9IHVzZVJlZjxFZGl0YWJsZVZhbHVlPEJpZz4+KCk7XG5cbiAgICBjb25zdCBnZXREZWZhdWx0UmFkaXVzID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gcHJvcHMuZGVmYXVsdFJhZGl1cy52YWx1ZT8udG9OdW1iZXIoKSA/PyAzMDtcbiAgICB9O1xuXG4gICAgY29uc3QgbG9hZEdlb2ZlbmNlID0gKGl0ZW1zOiBPYmplY3RJdGVtW10pID0+IHtcbiAgICAgICAgY29uc3QgZGF0YTogQXJyYXk8SUdlb2ZlbmNlIHwgdW5kZWZpbmVkPiA9IGl0ZW1zXG4gICAgICAgICAgICAubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wcy5pZC5nZXQoaXRlbSkudmFsdWUgJiYgcHJvcHMubGF0aXR1ZGUuZ2V0KGl0ZW0pLnZhbHVlICYmIHByb3BzLmxvbmdpdHVkZS5nZXQoaXRlbSkudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwcm9wcy5pZC5nZXQoaXRlbSkudmFsdWUhLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQocHJvcHMubGF0aXR1ZGUuZ2V0KGl0ZW0pLnZhbHVlISksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChwcm9wcy5sb25naXR1ZGUuZ2V0KGl0ZW0pLnZhbHVlISlcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6IHByb3BzLnJhZGl1c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gcHJvcHMucmFkaXVzLmdldChpdGVtKS52YWx1ZT8udG9OdW1iZXIoKSA/PyBnZXREZWZhdWx0UmFkaXVzKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGdldERlZmF1bHRSYWRpdXMoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRDb2xvcjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wcy5kZWZhdWx0Q29sb3IgJiYgcHJvcHMuZGVmYXVsdENvbG9yLmdldChpdGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHByb3BzLmRlZmF1bHRDb2xvci5nZXQoaXRlbSkudmFsdWUgPz8gXCIjMjY0YWU1XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBcIiMyNjRhZTVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNvbG9yOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzLmFjdGl2ZUNvbG9yICYmIHByb3BzLmFjdGl2ZUNvbG9yLmdldChpdGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHByb3BzLmFjdGl2ZUNvbG9yLmdldChpdGVtKS52YWx1ZSA/PyBcIiMzY2IzM2RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiIzNjYjMzZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Ryb2tlT3BhY2l0eTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wcy5zdHJva2VPcGFjaXR5ICYmIHByb3BzLnN0cm9rZU9wYWNpdHkuZ2V0KGl0ZW0pID8gcHJvcHMuc3Ryb2tlT3BhY2l0eS5nZXQoaXRlbSkgOiAxLjAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHMuc3Ryb2tlV2VpZ2h0ICYmIHByb3BzLnN0cm9rZVdlaWdodC5nZXQoaXRlbSkgPyBwcm9wcy5zdHJva2VXZWlnaHQuZ2V0KGl0ZW0pIDogMyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzLmZpbGxPcGFjaXR5ICYmIHByb3BzLmZpbGxPcGFjaXR5LmdldChpdGVtKSA/IHByb3BzLmZpbGxPcGFjaXR5LmdldChpdGVtKSA6IDEuMFxuICAgICAgICAgICAgICAgICAgICB9IGFzIElHZW9mZW5jZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmlsdGVyKGl0ID0+ICEhaXQpO1xuXG4gICAgICAgIGlmIChpc0RpZmZlcmVudERhdGEoZGF0YSBhcyBJR2VvZmVuY2VbXSwgZGF0YVJlZi5jdXJyZW50KSkge1xuICAgICAgICAgICAgZGF0YVJlZi5jdXJyZW50ID0gZGF0YSBhcyBJR2VvZmVuY2VbXTtcbiAgICAgICAgICAgIGRpc3BhdGNoKHVwZGF0ZUdlb2ZlbmNlKFsuLi5kYXRhXSBhcyBJR2VvZmVuY2VbXSkpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG9uR2VvZmVuY2UgPSAoaWQ6IHN0cmluZywgbWV0YWRhdGE6IG51bWJlcikgPT4ge1xuICAgICAgICBpZiAoYWN0aW9uSW4uY3VycmVudCkge1xuICAgICAgICAgICAgaWYgKGFjdGlvbkluLmN1cnJlbnQuY2FuRXhlY3V0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChjYW5TZXRBdHRyaWJ1dGVWYWx1ZShhY3Rpb25JbklELmN1cnJlbnQpICYmIGNhblNldEF0dHJpYnV0ZVZhbHVlKGFjdGlvbkluRGlzdGFuY2UuY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uSW5JRC5jdXJyZW50IS5zZXRWYWx1ZShpZCk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkluRGlzdGFuY2UuY3VycmVudCEuc2V0VmFsdWUobmV3IEJpZyhtZXRhZGF0YS50b0ZpeGVkKDIpKSk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkluLmN1cnJlbnQuZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhbm5vdCBzZXQgR2VvZmVuY2UgSUQgYW5kIEdlb2ZlbmNlIGRpc3RhbmNlIGF0dHJpYnV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhbm5vdCBleGVjdXRlIEdlb2ZlbmNlIElOIGV2ZW50XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IG9uR2VvZmVuY2VPdXQgPSAoaWQ6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAoYWN0aW9uT3V0LmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGlmIChhY3Rpb25PdXQuY3VycmVudC5jYW5FeGVjdXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhblNldEF0dHJpYnV0ZVZhbHVlKGFjdGlvbk91dElELmN1cnJlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbk91dElELmN1cnJlbnQhLnNldFZhbHVlKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uT3V0LmN1cnJlbnQuZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhbm5vdCBzZXQgR2VvZmVuY2UgT3V0IElEIGF0dHJpYnV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNhbm5vdCBleGVjdXRlIEdlb2ZlbmNlIE9VVCBldmVudFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBvbkdlb2ZlbmNlUG9zaXRpb24gPSAobGF0OiBzdHJpbmcsIGxvbmc6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uQWN0aW9uICYmXG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uTGF0aXR1ZGUgJiZcbiAgICAgICAgICAgIHByb3BzLm9uR2VvZmVuY2VDdXJyZW50UG9zaXRpb25Mb25naXR1ZGVcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uTGF0aXR1ZGUuc2V0VmFsdWUobGF0KTtcbiAgICAgICAgICAgIHByb3BzLm9uR2VvZmVuY2VDdXJyZW50UG9zaXRpb25Mb25naXR1ZGUuc2V0VmFsdWUobG9uZyk7XG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uQWN0aW9uLmV4ZWN1dGUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoc3RhdGUubWFwUmVhZHkgJiYgcHJvcHMuZGF0YS5pdGVtcykge1xuICAgICAgICAgICAgbG9hZEdlb2ZlbmNlKHByb3BzLmRhdGEuaXRlbXMpO1xuICAgICAgICB9XG4gICAgfSwgW3Byb3BzLmRhdGEuaXRlbXMsIHN0YXRlLm1hcFJlYWR5XSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBkaXNwYXRjaChcbiAgICAgICAgICAgIHVwZGF0ZUdlb2ZlbmNlT3B0aW9ucyh7XG4gICAgICAgICAgICAgICAgZW5hYmxlZDogcHJvcHMuZ2VvZmVuY2VFbmFibGVkLnZhbHVlID8/IHRydWUsXG4gICAgICAgICAgICAgICAgc2V0VmlldzogcHJvcHMuZ2VvZmVuY2VTZXRWaWV3RW5hYmxlZC52YWx1ZSA/PyB0cnVlLFxuICAgICAgICAgICAgICAgIG1heGltdW1BZ2U6IHByb3BzLm1heGltdW1BZ2UudmFsdWU/LnRvTnVtYmVyKCkgPz8gMFxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9LCBbcHJvcHMubWF4aW11bUFnZS52YWx1ZSwgcHJvcHMuZ2VvZmVuY2VFbmFibGVkLnZhbHVlLCBwcm9wcy5nZW9mZW5jZVNldFZpZXdFbmFibGVkLnZhbHVlXSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBhY3Rpb25Jbi5jdXJyZW50ID0gcHJvcHMub25HZW9mZW5jZUFjdGlvbjtcbiAgICAgICAgYWN0aW9uSW5JRC5jdXJyZW50ID0gcHJvcHMub25HZW9mZW5jZUlkO1xuICAgICAgICBhY3Rpb25JbkRpc3RhbmNlLmN1cnJlbnQgPSBwcm9wcy5vbkdlb2ZlbmNlRGlzdGFuY2U7XG4gICAgICAgIGFjdGlvbk91dC5jdXJyZW50ID0gcHJvcHMub25HZW9mZW5jZU91dEFjdGlvbjtcbiAgICAgICAgYWN0aW9uT3V0SUQuY3VycmVudCA9IHByb3BzLm9uR2VvZmVuY2VPdXRJZDtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQWN0aW9uICYmXG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlSWQgJiZcbiAgICAgICAgICAgIHByb3BzLm9uR2VvZmVuY2VBY3Rpb24uY2FuRXhlY3V0ZSAmJlxuICAgICAgICAgICAgIXN0YXRlLmdlb2ZlbmNlQWN0aW9uXG4gICAgICAgICkge1xuICAgICAgICAgICAgZGlzcGF0Y2godXBkYXRlR2VvZmVuY2VBY3Rpb24ob25HZW9mZW5jZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgcHJvcHMub25HZW9mZW5jZU91dEFjdGlvbiAmJlxuICAgICAgICAgICAgcHJvcHMub25HZW9mZW5jZU91dElkICYmXG4gICAgICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlT3V0QWN0aW9uLmNhbkV4ZWN1dGUgJiZcbiAgICAgICAgICAgICFzdGF0ZS5nZW9mZW5jZU91dEFjdGlvblxuICAgICAgICApIHtcbiAgICAgICAgICAgIGRpc3BhdGNoKHVwZGF0ZUdlb2ZlbmNlT3V0QWN0aW9uKG9uR2VvZmVuY2VPdXQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHByb3BzLm9uR2VvZmVuY2VDdXJyZW50UG9zaXRpb25BY3Rpb24gJiZcbiAgICAgICAgICAgIHByb3BzLm9uR2VvZmVuY2VDdXJyZW50UG9zaXRpb25MYXRpdHVkZSAmJlxuICAgICAgICAgICAgcHJvcHMub25HZW9mZW5jZUN1cnJlbnRQb3NpdGlvbkxvbmdpdHVkZSAmJlxuICAgICAgICAgICAgcHJvcHMub25HZW9mZW5jZUN1cnJlbnRQb3NpdGlvbkFjdGlvbi5jYW5FeGVjdXRlICYmXG4gICAgICAgICAgICAhc3RhdGUuZ2VvZmVuY2VQb3NpdGlvbkFjdGlvblxuICAgICAgICApIHtcbiAgICAgICAgICAgIGRpc3BhdGNoKHVwZGF0ZUdlb2ZlbmNlUG9zaXRpb25BY3Rpb24ob25HZW9mZW5jZVBvc2l0aW9uKSk7XG4gICAgICAgIH1cbiAgICB9LCBbXG4gICAgICAgIHByb3BzLm9uR2VvZmVuY2VBY3Rpb24sXG4gICAgICAgIHByb3BzLm9uR2VvZmVuY2VJZCxcbiAgICAgICAgcHJvcHMub25HZW9mZW5jZU91dEFjdGlvbixcbiAgICAgICAgcHJvcHMub25HZW9mZW5jZU91dElkLFxuICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uQWN0aW9uLFxuICAgICAgICBwcm9wcy5vbkdlb2ZlbmNlQ3VycmVudFBvc2l0aW9uTGF0aXR1ZGUsXG4gICAgICAgIHByb3BzLm9uR2VvZmVuY2VDdXJyZW50UG9zaXRpb25Mb25naXR1ZGVcbiAgICBdKTtcblxuICAgIHJldHVybiA8UmVhY3QuRnJhZ21lbnQgLz47XG59XG4iXSwibmFtZXMiOlsidXNlQ29udGV4dCIsInVzZVJlZiIsIkJpZyIsInVzZUVmZmVjdCIsImNyZWF0ZUVsZW1lbnQiLCJSZWFjdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztJQUVBLElBQVksVUFhWDtJQWJELFdBQVksVUFBVTtRQUNsQix5REFBVyxDQUFBO1FBQ1gsdURBQVUsQ0FBQTtRQUNWLHVEQUFVLENBQUE7UUFDVix1REFBVSxDQUFBO1FBQ1YsbUVBQWdCLENBQUE7UUFDaEIseURBQVcsQ0FBQTtRQUNYLHFFQUFpQixDQUFBO1FBQ2pCLDJFQUFvQixDQUFBO1FBQ3BCLHFGQUF5QixDQUFBO1FBQ3pCLHVFQUFrQixDQUFBO1FBQ2xCLGtFQUFlLENBQUE7UUFDZiwwRUFBbUIsQ0FBQTtJQUN2QixDQUFDLEVBYlcsVUFBVSxLQUFWLFVBQVUsUUFhckI7YUFtR2UsY0FBYyxDQUFDLElBQWlCO1FBQzVDLE9BQU87WUFDSCxJ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

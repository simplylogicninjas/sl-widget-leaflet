import e,{useContext as t,useRef as o,useEffect as r,createElement as a}from"react";var n;!function(e){e[e.SetMapReady=0]="SetMapReady",e[e.SetMapName=1]="SetMapName",e[e.SetMarkers=2]="SetMarkers",e[e.SetGeoJSON=3]="SetGeoJSON",e[e.SetGeoJSONAction=4]="SetGeoJSONAction",e[e.SetGeofence=5]="SetGeofence",e[e.SetGeofenceAction=6]="SetGeofenceAction",e[e.SetGeofenceOutAction=7]="SetGeofenceOutAction",e[e.SetGeofencePositionAction=8]="SetGeofencePositionAction",e[e.SetGeofenceOptions=9]="SetGeofenceOptions",e[e.SetMarkerAction=10]="SetMarkerAction",e[e.SetMarkerDragAction=11]="SetMarkerDragAction"}(n||(n={}));function i(i){const{state:c,dispatch:M}=t(mx.slmap.context),u=o([]),k=e=>{const t=e.map((e=>{var t,o;if(i.id.get(e).value&&i.latitude.get(e).value&&i.longitude.get(e).value){const r=null===(t=i.content)||void 0===t?void 0:t.get(e),a=null===(o=i.popupContent)||void 0===o?void 0:o.get(e),n=i.id.get(e).value.toString(),c=i.latitude.get(e).value,M=i.longitude.get(e).value;return{content:r,popupContent:a,id:n,draggable:!!i.draggable.get(e).value,position:[parseFloat(c),parseFloat(M)]}}})).filter((e=>!!e));var o,r,a;r=t,a=u.current,JSON.stringify(r)!==JSON.stringify(a)&&(u.current=t,M((o=[...t],{type:n.SetMarkers,payload:[...o]})))},l=e=>{i.onMarkerClickAction&&i.onMarkerID&&(i.onMarkerID.setValue(e),i.onMarkerClickAction.execute())},S=(e,t,o)=>{i.onMarkerDragAction&&i.onMarkerMoveID&&i.onMarkerMoveLatitude&&i.onMarkerMoveLongitude&&(i.onMarkerMoveID.setValue(o),i.onMarkerMoveLatitude.setValue(e),i.onMarkerMoveLongitude.setValue(t),i.onMarkerDragAction.execute())};return r((()=>{c.mapReady&&i.data.items&&k(i.data.items)}),[i.data.items,c.mapReady]),r((()=>{var e;i.onMarkerClickAction&&i.onMarkerID&&M((e=l,{type:n.SetMarkerAction,payload:e})),i.onMarkerDragAction&&i.onMarkerMoveID&&i.onMarkerMoveLatitude&&i.onMarkerMoveLongitude&&M(function(e){return{type:n.SetMarkerDragAction,payload:e}}(S))}),[i.onMarkerClickAction,i.onMarkerID,i.onMarkerDragAction,i.onMarkerMoveID,i.onMarkerMoveLatitude,i.onMarkerMoveLongitude]),a(e.Fragment,null)}export{i as SLLeafletMarkers};

define(["exports","react","big.js"],(function(e,t,n){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c,i=o(t),u=o(n);!function(e){e[e.SetMapReady=0]="SetMapReady",e[e.SetMapName=1]="SetMapName",e[e.SetMarkers=2]="SetMarkers",e[e.SetGeoJSON=3]="SetGeoJSON",e[e.SetGeoJSONAction=4]="SetGeoJSONAction",e[e.SetGeofence=5]="SetGeofence",e[e.SetGeofenceAction=6]="SetGeofenceAction",e[e.SetGeofenceOutAction=7]="SetGeofenceOutAction",e[e.SetGeofencePositionAction=8]="SetGeofencePositionAction",e[e.SetGeofenceOptions=9]="SetGeofenceOptions",e[e.SetMarkerAction=10]="SetMarkerAction",e[e.SetMarkerDragAction=11]="SetMarkerDragAction"}(c||(c={}));const r=e=>e&&"available"===e.status;e.SLLeafletGeofence=function(e){const{state:n,dispatch:o}=t.useContext(mx.slmap.context),a=t.useRef([]),l=t.useRef(),f=t.useRef(),s=t.useRef(),d=t.useRef(),G=t.useRef(),g=()=>{var t,n;return null!==(n=null===(t=e.defaultRadius.value)||void 0===t?void 0:t.toNumber())&&void 0!==n?n:30},v=t=>{const n=t.map((t=>{var n,o,c,i;return e.id.get(t).value&&e.latitude.get(t).value&&e.longitude.get(t).value?{id:e.id.get(t).value.toString(),position:[parseFloat(e.latitude.get(t).value),parseFloat(e.longitude.get(t).value)],radius:e.radius&&null!==(o=null===(n=e.radius.get(t).value)||void 0===n?void 0:n.toNumber())&&void 0!==o?o:g(),defaultColor:e.defaultColor&&e.defaultColor.get(t)&&null!==(c=e.defaultColor.get(t).value)&&void 0!==c?c:"#264ae5",activeColor:e.activeColor&&e.activeColor.get(t)&&null!==(i=e.activeColor.get(t).value)&&void 0!==i?i:"#3cb33d",strokeOpacity:e.strokeOpacity&&e.strokeOpacity.get(t)?e.strokeOpacity.get(t):1,strokeWeight:e.strokeWeight&&e.strokeWeight.get(t)?e.strokeWeight.get(t):3,fillOpacity:e.fillOpacity&&e.fillOpacity.get(t)?e.fillOpacity.get(t):1}:void 0})).filter((e=>!!e));var i,u;i=n,u=a.current,JSON.stringify(i)!==JSON.stringify(u)&&(a.current=n,o(function(e){return{type:c.SetGeofence,payload:[...e]}}([...n])))},S=(e,t)=>{s.current&&(s.current.canExecute?r(d.current)&&r(G.current)?(d.current.setValue(e),G.current.setValue(new u.default(t.toFixed(2))),s.current.execute()):console.warn("Cannot set Geofence ID and Geofence distance attribute"):console.warn("Cannot execute Geofence IN event"))},p=e=>{l.current&&(l.current.canExecute?r(f.current)?(f.current.setValue(e),l.current.execute()):console.warn("Cannot set Geofence Out ID attribute"):console.warn("Cannot execute Geofence OUT event"))},A=(t,n)=>{e.onGeofenceCurrentPositionAction&&e.onGeofenceCurrentPositionLatitude&&e.onGeofenceCurrentPositionLongitude&&(e.onGeofenceCurrentPositionLatitude.setValue(t),e.onGeofenceCurrentPositionLongitude.setValue(n),e.onGeofenceCurrentPositionAction.execute())};return t.useEffect((()=>{n.mapReady&&e.data.items&&v(e.data.items)}),[e.data.items,n.mapReady]),t.useEffect((()=>{var t,n,i,u,r;o((r={enabled:null===(t=e.geofenceEnabled.value)||void 0===t||t,setView:null===(n=e.geofenceSetViewEnabled.value)||void 0===n||n,maximumAge:null!==(u=null===(i=e.maximumAge.value)||void 0===i?void 0:i.toNumber())&&void 0!==u?u:0},{type:c.SetGeofenceOptions,payload:r}))}),[e.maximumAge.value,e.geofenceEnabled.value,e.geofenceSetViewEnabled.value]),t.useEffect((()=>{var t;s.current=e.onGeofenceAction,d.current=e.onGeofenceId,G.current=e.onGeofenceDistance,l.current=e.onGeofenceOutAction,f.current=e.onGeofenceOutId,e.onGeofenceAction&&e.onGeofenceId&&e.onGeofenceAction.canExecute&&!n.geofenceAction&&o((t=S,{type:c.SetGeofenceAction,payload:t})),e.onGeofenceOutAction&&e.onGeofenceOutId&&e.onGeofenceOutAction.canExecute&&!n.geofenceOutAction&&o(function(e){return{type:c.SetGeofenceOutAction,payload:e}}(p)),e.onGeofenceCurrentPositionAction&&e.onGeofenceCurrentPositionLatitude&&e.onGeofenceCurrentPositionLongitude&&e.onGeofenceCurrentPositionAction.canExecute&&!n.geofencePositionAction&&o(function(e){return{type:c.SetGeofencePositionAction,payload:e}}(A))}),[e.onGeofenceAction,e.onGeofenceId,e.onGeofenceOutAction,e.onGeofenceOutId,e.onGeofenceCurrentPositionAction,e.onGeofenceCurrentPositionLatitude,e.onGeofenceCurrentPositionLongitude]),t.createElement(i.default.Fragment,null)},Object.defineProperty(e,"__esModule",{value:!0})}));
